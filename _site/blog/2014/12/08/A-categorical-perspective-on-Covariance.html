<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
   <title>A Categorical Perspective On Covariance</title>
   <meta name="author" content="Heinrich Hartmann"/>

   <!-- syntax highlighting CSS -->
   <link rel="stylesheet" href="/css/syntax.css" type="text/css"/>

   <!-- Homepage CSS -->
   <link rel="stylesheet" href="/css/screen.css" type="text/css" media="screen, projection"/>

   <!-- RSS feed -->
   <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml">

   <!-- Favicon -->
   <link rel="icon" type="image/png" href="/images/favicon.png">

   
   </head>
<body>

<div class="site">
  <div class="title">
    <a href="/">Heinrich Hartmann</a>
    <a class="extra" href="/opinion.html">opinion</a>
    <a class="extra" href="/consulting.html">consulting</a>
    <a class="extra" href="/about.html">about</a>
    <div class="social" style='float:right'>
      <div style='float:right'>
        <a href="http://eepurl.com/ccmH-T"><img src="/images/mail_icon.svg" width="25px"/></a>
      </div>
      <div style='float:right'>
        <a href="/feed.xml"><img src="/images/rss_icon.svg" width="25px" style="margin: 0 10px 0 0;"/></a>
      </div>
      <div style='float:right'>
        <a href="http://twitter.com/intent/follow?screen_name=HeinrichHartman"><img src="/images/twitter_icon.svg" width="25px" style="margin: 0 10px 0 0;"></a>
      </div>
    </div>
  </div>

  <div id="post">

  <!-- Title -->
  <h1> A Categorical Perspective On Covariance</h1>

  


  <!-- Meta -->
  <p class="meta">
    Written on 2014-12-08
    
    
  </p>

  <!-- Splash -->
  

  <!-- Post content -->
  <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>

<style> .center { margin-right: auto; margin-left:auto; display: block } </style>

<style src="/css/coderay.css"></style>

<!-- # A categorical perspective on Covariance -->

<p>For functions <script type="math/tex">f,g</script> on a measure space <script type="math/tex">\Omega, \mu</script> (e.g. a real
interval <script type="math/tex">[0,1]</script>) there is a well known scalar product</p>

<script type="math/tex; mode=display">\langle f,g \rangle = \int f \cdot g \, d\mu.</script>

<p>This scalar product is of fundamental importance to the study of
function and operators on measure spaces (Function Analysis).  For
example, there is a rich theory of how to decomposes functions on an
interval into orthogonal Fourier-components.</p>

<p>If <script type="math/tex">\mu</script> is a probability measure, we can regard <script type="math/tex">f,g</script> as random
variables. In this setting the viewpoint changes quite a bit.  We give
<script type="math/tex">f,g</script> new names: <script type="math/tex">X,Y</script>. We are no longer interested in <script type="math/tex">\Omega</script>,
and also rarely consider the scalar product. Instead the focus lies on
expectation</p>

<script type="math/tex; mode=display">E[X] = \int X \, d\mu</script>

<p>and the covariance</p>

<script type="math/tex; mode=display">Cov[X,Y] = E[X \cdot Y]  - E[X] E[Y].</script>

<p>This note considers the relation between these the probabilistic
notions and the functional point of view.</p>

<h2 id="constant-split">Constant Split</h2>

<p>Let <script type="math/tex">\Omega, P</script> be a probability space. Consider the vector space
of square integrable functions:</p>

<script type="math/tex; mode=display">% <![CDATA[
\def\IR{\mathbb{R}}
   \def\LL{L^2(\Omega, \IR)}
   \LL = \{ x:\Omega \rightarrow \IR \,|\, \int |x|^2 dP < \infty \} / \sim. %]]></script>

<p>See e.g. <a href="https://en.wikipedia.org/wiki/Lp_space#Lp_spaces">wikipedia</a> for
the details. We have the integral linear operator</p>

<script type="math/tex; mode=display">\def\lra{\longrightarrow}
   I : \LL \lra \IR, \quad x \mapsto \int x \,dP.</script>

<p>The inclusion of the constant functions <script type="math/tex">\iota</script> leaves us with a sequence:</p>

<script type="math/tex; mode=display">\IR \overset{\iota}{\lra} \LL \overset{I}{\lra} \IR,</script>

<p>whose composition <script type="math/tex">I \circ \iota = id_\IR</script>, since <script type="math/tex">P</script> is a
probability measure. We get an induced splitting of <script type="math/tex">\LL</script> into
constant functions plus functions with integral <script type="math/tex">I = 0</script>:</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{align*}
    \def\isom{\cong}
    \LL   &= \IR \oplus \LL_0. \\
    \LL_0 &= \{ f \,|\, I(f) = 0 \} \isom \LL / \text{const.}
\end{align*} %]]></script>

<p>A function <script type="math/tex">x</script> can be decomposed accordingly into its constant part <script type="math/tex">I(x)</script> and
its integral-0 part: <script type="math/tex">N(x) = x - I(x)</script>.</p>

<h2 id="bilinear-forms">Bilinear Forms</h2>

<p>The space <script type="math/tex">\LL</script> comes with a scalar product</p>

<script type="math/tex; mode=display">S: \LL \times \LL \lra \IR, \quad x,y \mapsto I(x\cdot y)</script>

<p>which is non-degenerate and complete and thus makes this space into a
<a href="https://en.wikipedia.org/wiki/Hilbert_space">Hilbert Space</a>.</p>

<p>The covariance product is defined as</p>

<script type="math/tex; mode=display">Cov(x,y) = S(x,y) - I(x) I(y) = S(x - I(x), y - I(y)) = S(N(x),N(y)).</script>

<p>This product is bilinear but degenerate. The radical of <script type="math/tex">Cov</script> are
precisely the
(<a href="https://en.wikipedia.org/wiki/Almost_everywhere">almost</a>) constant
functions <script type="math/tex">\iota(\IR)</script>.</p>

<script type="math/tex; mode=display">Cov(x,x) = 0  \Leftrightarrow S(x - I(x), x - I(x)) = 0 \Leftrightarrow x = I(x) \; a.e.</script>

<p>In the light of the above decomposition, we see that <script type="math/tex">Cov</script> is the
restriction of <script type="math/tex">S</script> to <script type="math/tex">\LL_0</script> extended back to <script type="math/tex">\LL</script> using the
projection <script type="math/tex">N(x) = x - I(x)</script>.</p>

<h2 id="conclusion">Conclusion</h2>

<ul>
  <li>
    <p>The space of integral-0 function <script type="math/tex">\LL_0</script> together with the
covariance product <script type="math/tex">Cov</script> is a Hilbert Space.</p>
  </li>
  <li>
    <p>The natural inclusion <script type="math/tex">\LL_0 \rightarrow \LL</script> is isometric
with adjoint linear operator <script type="math/tex">N(x) = x - I(x)</script>.</p>
  </li>
  <li>
    <p>There is an orthogonal direct sum decomposition:</p>

    <script type="math/tex; mode=display">\LL \cong \IR \oplus  \LL_0, \quad f \mapsto (I(f),N(f))</script>
  </li>
</ul>

<h2 id="update-2015-05-17-correlation-as-cosine">Update 2015-05-17: Correlation as Cosine</h2>

<p>The <a href="http://en.wikipedia.org/wiki/Pearson_product-moment_correlation_coefficient">Pearson
correlation</a>
is defined as:</p>

<script type="math/tex; mode=display">\rho(x,y) = \frac{Cov(x,y)}{\sqrt{Cov(x,x) Cov(y,y)}}.</script>

<p>It measures the linear dependece between two random variables. E.g. in
 the case of a discrete probability measure obtained from a sample,
 the correlation is the ratio between explained variance in a linear
 regression and total variance of the sample
 cf. <a href="http://en.wikipedia.org/wiki/Coefficient_of_determination">wikipedia</a>.</p>

<figure>
    <img src="/assets/Covariance_files/cor.png" />
    <img src="/assets/Covariance_files/nocor.png" />
    <figcaption>Correlated (\rho ~ 0.88) and non-corrleated (\rho ~ -0.14) samples.</figcaption>
</figure>

<p>In analogy to the Euclidean plane, we define the cosine similarity between two functions by</p>

<script type="math/tex; mode=display">cossim(x,y) = \frac{S(x,y)}{\sqrt{S(x,x) S(y,y)}}.</script>

<p>Hence for centered functions <script type="math/tex">x,y \in \LL_0</script> we have</p>

<script type="math/tex; mode=display">cossim(x,y) = \rho(x,y),</script>

<p>which gives a surprising relation between two different geometric
interpretations of the same data:</p>

<ul>
  <li>Regrssion line of coefficient pairs <script type="math/tex">(x_i,y_i)</script> in <script type="math/tex">\IR^2</script></li>
  <li>Angle between vectors <script type="math/tex">(x_1,\dots,x_n)</script> and <script type="math/tex">(y_1,\dots,y_n)</script> in <script type="math/tex">\IR^n</script>.</li>
</ul>

<p>Note, that for cetnered functions (<script type="math/tex">I(x) = I(y) = 0</script>) the regression line
will always pass through the origin and the slope can be calculated to</p>

<script type="math/tex; mode=display">\hat{a}(x,y) = Cov(x,y)/Cov(x,x).</script>

<p>However, at the moment I do not see how this helps to understand the
above observation. My feeling is, that there should be a more
conceptual reason for it. By interpreting <script type="math/tex">x,y</script> as maps <script type="math/tex">\IR^2
\lra \IR^n</script> we can bring duality theory for vector spaces into play
and maybe gain more insight form this perspective.</p>


  <!-- Comments -->
  
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES * * */
      var disqus_shortname = 'heinrichhartmann';
      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments</a></noscript>
  
</div>


  <div class="footer">
    <div class="contact">
      <p>
        Licensed under <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">CC-BY 4.0.</a>
        <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title" style="display:none">This blog</span>
        <span xmlns:cc="http://creativecommons.org/ns#" property="cc:attributionName" style="display:none">Heinrich Hartmann</span>
      </p>
    </div>
  </div>
</div>

<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-53959000-1', 'auto');
  ga('send', 'pageview');
</script>

</body>
</html>
